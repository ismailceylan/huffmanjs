(function(s,u){typeof exports=="object"&&typeof module<"u"?u(exports):typeof define=="function"&&define.amd?define(["exports"],u):(s=typeof globalThis<"u"?globalThis:s||self,u(s.huffmanjs={}))})(this,function(s){"use strict";function u(e){const t={};let r="";for(const n of e)r+=n.charCodeAt(0).toString(2).padStart(8,"0");for(let n=0;n<r.length;n+=32){const o=r.slice(n,n+16),i=r.slice(n+16,n+32),l=parseInt(o,2),f=i.replace(/^0*(.*)/,"$1");t[f]=l}return t}function m(e){let t=e.split("").map(r=>r.charCodeAt(0));return t[0]>0&&(t[0]*=255,t[0]++),t.reduce((r,n)=>r+n,0)}function h(e){let t="";for(const o in e){const i=e[o],l=16-i.length%16,f=i.padStart(i.length+l,"0"),d=parseInt(o).toString(2).padStart(16,"0");t+=d+f}const r=a(t)[0],n=a(r.length.toString(2).padStart(16,"0"))[0];return[r,n]}function b(e){const t={};r(e[0]);function r(n,o="1"){n!==null&&(n.char!==null&&(t[n.char]=o),r(n.left,o+"1"),r(n.right,o+"0"))}return t}function y(e){const t={};for(let r=0;r<e.length;r++){const n=e[r];t[n]?t[n]++:t[n]=1}return t}function S(e,t){let r="";for(const n of e)r+=t[n];return r}const c="Ã­ce9";function C([e,t],r){const[n,o]=h(r),i=String.fromCharCode(t),l=[c,i,o,n,e],f=[c,i,e];return[l.join(""),f.join(""),n]}function k(e,t){return B(w(e,t))}function w(e,t){if(e.slice(0,c.length)!==c)throw new Error("Unknown file format!");const r={padEnd:e[c.length].charCodeAt(0)},n=t?t.length:m(e[c.length+1]+e[c.length+2]),o=t||e.slice(c.length+3,c.length+3+n);return r.bitmap=u(o),r.raw=t?e.slice(c.length+1):e.slice(c.length+3+n),r}function j(e){e=e.split("").map(H=>H.charCodeAt(0));const t=y(e),r=q(t),n=b(r),o=S(e,n),i=a(o),[l,f,d]=C(i,n);return[l,n,f,d]}function q(e){const t=Object.keys(e).map(r=>new p(r,e[r])).sort(g);for(;t.length>1;){const r=t.shift(),n=t.shift(),o=new p(null,r.freq+n.freq);o.left=r,o.right=n,t.push(o),t.sort(g)}return t}function a(e){const t=[];let r=0;for(let n=0;n<e.length;n+=8){let o=e.slice(n,n+8);o.length<8&&(r=8-o.length,o=o.padEnd(8,"0"));const i=parseInt(o,2),l=String.fromCharCode(i);t.push(l)}return[t.join(""),r]}function B(e){let t="";for(const o of e.raw)t+=o.charCodeAt(0).toString(2).padStart(8,"0");e.padEnd>0&&(t=t.slice(0,-e.padEnd));let r=[],n="";for(const o of t){n+=o;const i=e.bitmap[n];i!==void 0&&(r.push(String.fromCharCode(i)),n="")}return r.join("")}function g(e,t){return e.freq-t.freq}class p{constructor(t,r){this.char=t,this.freq=r,this.left=null,this.right=null}}s.compress=j,s.decompress=k,s.serializeHuffmanCode=h,s.unserializeHuffmanCode=u,Object.defineProperty(s,Symbol.toStringTag,{value:"Module"})});
